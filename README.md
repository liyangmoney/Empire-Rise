# 🏰 帝国崛起：蛮荒争霸

> 前后端分离的 SLG 游戏 - Node.js + Socket.io + H5客户端
> 
> 🐳 **支持 Docker 一键部署**

## ✨ 已实现功能

### ✅ 资源系统
- 6种资源：木材/石材/粮食/铁矿/水晶/金币
- 仓库容量与升级
- 自动产出 + 手动采集
- 实时同步

### ✅ 建筑系统
- 伐木场、农场、兵营等基础建筑
- 建筑等级影响产出/容量
- 升级消耗资源

### ✅ 军队系统
- 3种基础兵种：步兵/弓兵/骑兵
- **兵种克制关系**：步兵→骑兵→弓兵→步兵
- 训练消耗粮食/木材
- 军队上限（由建筑等级决定）
- 士气系统（影响战斗力 ±20%）
- 训练队列（异步完成）
- 粮食消耗与士气惩罚

### ✅ 战斗系统 (NEW! v0.3)
- 🎯 攻打NPC：野生怪物/据点/城邦
- ⚔️ **自动战斗**：10回合上限，瞬间完成
- 📊 **伤害计算**：攻击 × 克制系数 × 士气 - 防御
- 💀 **伤亡系统**：阵亡+伤病，医院可恢复
- 🎁 **战斗奖励**：资源掠夺、经验、道具掉落
- 📈 **动态难度**：根据玩家战力调整

---

## 🚀 快速开始（Docker）

```bash
# 1. 克隆代码
git clone https://github.com/liyangmoney/Empire-Rise.git
cd Empire-Rise

# 2. 一键启动
docker-compose up --build

# 3. 浏览器访问
# http://localhost:3000
```

---

## 🎮 游戏指南

### 核心闭环
```
收集资源 → 训练军队 → 攻打NPC → 获得奖励 → 扩张帝国
```

### 兵种克制
| 兵种 | 克制 | 被克制 | 训练消耗 |
|------|------|--------|----------|
| 步兵 | 骑兵 | 弓兵 | 粮食×20 |
| 弓兵 | 步兵 | 骑兵 | 粮食×25+木材×10 |
| 骑兵 | 弓兵 | 步兵 | 粮食×40+木材×20 |

**克制系数：** 克制方 1.5倍伤害，被克制方 0.7倍

### NPC类型
| 类型 | 难度 | 掉落 |
|------|------|------|
| 野狼/野猪 | ⭐ 简单 | 木材、粮食 |
| 山贼营地 | ⭐⭐ 中等 | 木材、粮食、铁矿 |
| 矿场守卫 | ⭐⭐⭐ 困难 | 铁矿、将领碎片 |
| 小型城邦 | ⭐⭐⭐⭐⭐ 极难 | 水晶、金币、稀有道具 |

### 战斗流程
1. 切换到「🎯 战斗」标签
2. 查看可挑战的NPC（绿色标记=推荐）
3. 点击「发起攻击」
4. 查看战斗结果与战报

---

## 📁 项目结构
```
Empire-Rise/
├── server/
│   ├── src/
│   │   ├── core/
│   │   │   ├── components/
│   │   │   │   ├── ResourceComponent.js
│   │   │   │   ├── BuildingComponent.js
│   │   │   │   ├── ArmyComponent.js
│   │   │   │   └── BattleComponent.js      # 战斗组件
│   │   │   └── systems/
│   │   │       ├── GameLoop.js
│   │   │       ├── TrainingSystem.js
│   │   │       └── BattleSystem.js         # 战斗系统
│   │   └── network/socket/handlers.js
│   └── package.json
├── client/
│   ├── index.html
│   └── src/main.js
├── shared/
│   ├── constants.js
│   ├── unitTypes.js
│   └── npcTypes.js                         # NPC配置
├── Dockerfile
├── docker-compose.yml
└── README.md
```

---

## 🔌 API 事件

### 战斗系统
| 事件 | 方向 | 说明 |
|------|------|------|
| `battle:getAvailableNpcs` | C→S | 获取可挑战NPC列表 |
| `battle:start` | C→S | 发起战斗 |
| `battle:started` | S→C | 战斗开始通知 |
| `battle:finished` | S→C | 战斗结果（含战报） |

---

## ⏭️ 后续开发

| 优先级 | 模块 | 状态 |
|--------|------|------|
| P1 | 将领系统 | 🚧 待开发 |
| P1 | 装备系统 | 🚧 待开发 |
| P2 | 科技系统 | 🚧 待开发 |
| P2 | 疆域扩张 | 🚧 待开发 |
| P3 | 联盟/社交 | 🚧 待开发 |

---

## 📝 更新日志

### v0.3.0 (2024-02-12)
- ✅ 战斗系统 MVP
- ✅ NPC敌人（野怪/据点/城邦）
- ✅ 自动战斗与战报
- ✅ 资源掠夺与掉落

### v0.2.0
- ✅ 军队系统
- ✅ 兵种克制
- ✅ 士气系统

### v0.1.0
- ✅ 资源系统 MVP
- ✅ 建筑系统 MVP