# 《帝国崛起：蛮荒争霸》需求文档 (PRD)

## 文档信息
- **版本**: v1.0
- **日期**: 2024-02-12
- **作者**: liyangmoney

---

## 1. 项目概述

### 1.1 游戏定位
策略经营 + 即时战斗 + 帝国模拟（SLG）游戏。玩家从蛮荒据点起步，通过收集资源、建设基地、培养军队、攻打NPC，最终建立横跨大陆的帝国。

### 1.2 核心体验
- **策略性**: 兵种克制、资源分配、战斗时机
- **成长感**: 从蛮荒到繁荣的视觉和数值成长
- **征服感**: 击败强敌、扩张疆域的成就感

### 1.3 目标用户
- 核心用户: 15-40岁策略经营爱好者
- 次核心: 帝国题材、PVE爱好者
- 轻度用户: 喜欢长期成长、不排斥轻度肝度

---

## 2. 核心玩法闭环

```
收集资源 → 建设基地 → 培养军队 → 攻打NPC → 扩张帝国 → 解锁高阶 → 挑战更强
```

---

## 3. 功能需求

### 3.1 资源系统

#### 3.1.1 资源类型
| 资源 | 类型 | 用途 | 获取方式 |
|------|------|------|----------|
| 木材 | 基础 | 建造建筑、制作武器 | 伐木场产出、地图采集 |
| 石材 | 基础 | 防御建筑、加固军营 | 采石场产出、地图采集 |
| 粮食 | 基础 | 训练军队、维持士气 | 农场产出、地图采集 |
| 铁矿 | 特殊 | 高阶科技、进阶兵种 | 铁矿场产出、NPC掉落 |
| 水晶 | 特殊 | 稀有兵种、终极科技 | 水晶矿产出、NPC掉落 |
| 金币 | 货币 | 快速购买、招募、修复 | 任务奖励、战斗掠夺 |

#### 3.1.2 资源获取
- **建筑产出**: 建造对应资源建筑，等级越高产出效率越高
- **地图采集**: 派遣士兵采集，可能遭遇NPC骚扰
- **NPC掉落**: 攻打NPC后根据等级掉落
- **任务奖励**: 完成任务获得

#### 3.1.3 资源存储与保护
- 基础资源仓库: 存储木材/石材/粮食，可升级扩容
- 特殊资源仓库: 存储铁矿/水晶，可升级扩容
- 防护科技: 减少被掠夺时的损失
- 城墙/箭塔: 阻挡NPC突袭

### 3.2 军队系统

#### 3.2.1 兵种分类
| 兵种 | 类型 | 克制 | 被克制 | 训练消耗 | 特点 |
|------|------|------|--------|----------|------|
| 步兵 | 基础 | 骑兵 | 弓兵 | 粮食×20 | 防御强 |
| 弓兵 | 基础 | 步兵 | 骑兵 | 粮食×25+木材×10 | 远程攻击 |
| 骑兵 | 基础 | 弓兵 | 步兵 | 粮食×40+木材×20 | 高机动 |
| 魔法兵 | 进阶 | - | - | 粮食×30+铁矿×15 | 群体伤害 |

#### 3.2.2 克制关系
- 克制系数: 1.5（优势）/ 1.0（平）/ 0.7（劣势）

#### 3.2.3 军队培养
- **训练**: 在军营训练，消耗资源，有时间成本
- **升级**: 士兵通过战斗获得经验，提升属性
- **装备**: 制作装备提升兵种属性
- **士气**: 影响战斗力（满值+20%，不足惩罚）

#### 3.2.4 军队管理
- 编队系统: 可创建多个编队
- 伤病系统: 受伤士兵送医治疗
- 军队上限: 由帝国等级、建筑等级决定

### 3.3 战斗系统

#### 3.3.1 战斗类型
| 类型 | 难度 | 掉落 |
|------|------|------|
| 野生NPC | ⭐ | 基础资源 |
| NPC据点 | ⭐⭐ | 基础+铁矿 |
| NPC城邦 | ⭐⭐⭐⭐⭐ | 水晶+金币+领土 |

#### 3.3.2 战斗规则
- 模式: 自动战斗（回合制简化）
- 时长: 最多10回合，超时未分胜负按剩余HP比例判定
- 伤害公式: `伤害 = (攻击+将领加成) × 克制系数 × 士气系数 - 防御`

#### 3.3.3 战斗结果
- **胜利**: 获得资源、经验、道具，士气+5
- **失败**: 士兵伤亡、士气-15，无奖励

### 3.4 帝国系统

#### 3.4.1 建筑分类
| 类型 | 建筑 | 功能 |
|------|------|------|
| 基础 | 伐木场/采石场/农场 | 资源产出 |
| 基础 | 资源仓库 | 存储资源 |
| 基础 | 兵营 | 训练士兵 |
| 防御 | 城墙/箭塔 | 防御保护 |
| 功能 | 医院/将领营/科技院 | 特殊功能 |

#### 3.4.2 帝国等级
- 等级: 1-20级
- 前期(1-5): 快速引导期
- 中期(6-12): 发展期，资源分配策略
- 后期(13-20): 争霸期，策略搭配核心

### 3.5 任务系统

#### 3.5.1 任务类型
| 类型 | 说明 | 刷新 |
|------|------|------|
| 主线任务 | 新手引导 | 链式解锁 |
| 日常任务 | 每日可做 | 每日刷新3个 |
| 成就任务 | 长期目标 | 永久存在 |

#### 3.5.2 任务进度追踪
- 自动记录: 采集/训练/战斗/建筑升级
- 完成提示: 任务完成时通知
- 奖励领取: 点击领取获得资源

### 3.6 将领系统

#### 3.6.1 将领品质
| 品质 | 颜色 | 基础属性 |
|------|------|----------|
| 普通 | 灰 | 1.0倍 |
| 稀有 | 蓝 | 1.2倍 |
| 史诗 | 紫 | 1.5倍 |
| 传说 | 金 | 2.0倍 |

#### 3.6.2 将领技能
- **群体伤害**: 对敌方全体造成伤害
- **治疗**: 恢复我方士兵HP
- **增益**: 提升攻击力/防御力
- **士气**: 恢复士气至满值

### 3.7 时间系统

#### 3.7.1 时间加速
| 模式 | 倍率 | 说明 |
|------|------|------|
| 正常 | 1x | 1秒=1秒 |
| 快速 | 60x | 1秒=1分钟 |
| 极速 | 300x | 1秒=5分钟 |

#### 3.7.2 游戏内时间
- 显示格式: 第X年 Y月 Z日
- 时间段: 早晨/下午/傍晚/深夜
- 每日刷新: 新的一天自动刷新日常任务

---

## 4. 非功能需求

### 4.1 性能需求
- 支持100+玩家同时在线
- 单请求响应时间 < 200ms
- 游戏循环稳定 1秒/TICK

### 4.2 技术架构
- 后端: Node.js + Socket.io
- 前端: H5 (HTML/CSS/JS)
- 部署: Docker + Docker Compose

### 4.3 用户体验
- 所有界面文字为中文
- 操作反馈即时（Toast提示）
- 资源消耗二次确认
- 错误提示友好

---

## 5. 接口需求

### 5.1 核心接口
- `empire:connect` - 连接创建帝国
- `resource:collect` - 采集资源
- `building:upgrade` - 升级建筑
- `army:train` - 训练士兵
- `battle:start` - 发起战斗
- `general:recruit` - 招募将领
- `task:claimReward` - 领取任务奖励
- `time:setSpeed` - 设置时间速度

---

## 6. 附录

### 6.1 数值参考
- 初始资源: 木材500/粮食300/金币100
- 军队上限基础: 50人
- 资源产出: 木材50/小时, 粮食30/小时
- 训练时间: 步兵10秒, 弓兵12秒, 骑兵20秒

### 6.2 后续扩展
- [ ] 联盟系统（多人合作）
- [ ] PVP竞技场
- [ ] 剧情任务
- [ ] 装备锻造系统
- [ ] 科技树完善
